/*!
 * @copyright Copyright &copy; Kartik Visweswaran, Krajee.com, 2014
 * @package yii2-editable
 * @version 1.0.0
 *
 * Editable Extension jQuery plugin
 *
 * Built for Yii Framework 2.0
 * Author: Kartik Visweswaran
 * Year: 2014
 * For more Yii related demos visit http://demos.krajee.com
 */!function(e){var t=function(t,i){return null===t||void 0===t||t==[]||""===t||i&&""===e.trim(t)},i=function(t,i){this.$element=e(t),this.init(i),this.listen()};i.prototype={constructor:i,init:function(t){var i=this;i.$container=e("#"+t.containerId),i.$form=i.$container.find(".kv-editable-form"),i.$value=i.$container.find(".kv-editable-value"),i.$popover=i.$container.find(".kv-editable-popover"),i.$btnSubmit=i.$container.find(".kv-editable-submit"),i.$btnReset=i.$container.find(".kv-editable-reset"),i.$loading=i.$container.find(".kv-editable-loading"),i.valueIfNull=t.valueIfNull},listen:function(){var i=this,a=i.$form,n=i.$btnSubmit,o=i.$btnReset,r=a.parent(),s=i.$popover,l=i.$loading,d=i.$element,u=i.valueIfNull,c=d.closest(".field-"+d.attr("id")),v=d.parent(),f=c.find(".help-block"),m=a.find('input[name="hasEditable"]'),p=t(c.attr("class"))||t(f.attr("class"));o.on("click",function(){m.val(0),setTimeout(function(){a[0].reset()},200)}),a.on("reset",function(){setTimeout(function(){a.data("kvEditableSubmit",!1),p?(v.find(".help-block").remove(),v.removeClass("has-error")):(c.removeClass("has-error"),f.html(" ")),s.popoverX("show")},200)}),n.on("click",function(){r.addClass("kv-editable-processing"),l.show(),m.val(1),setTimeout(function(){a.submit()},200)}),a.on("submit",function(n){var o="",d=i.$form.data("yiiActiveForm");e.ajax({type:a.attr("method"),url:a.attr("action"),data:a.serialize(),dataType:"json",success:function(n){var m=t(n.output)?i.$element.val():n.output;return t(n.message)?(a.find(".help-block").each(function(){o=e(this).text(),t(o.trim())||(l.hide(),s.popoverX("show"))}),t(o.trim())&&(l.hide(),t(m)&&(m=u),p?(v.find(".help-block").remove(),v.removeClass("has-error")):(c.removeClass("has-error"),f.html(" "),s.popoverX("hide"),i.$value.html(m),void 0!=d&&(a.yiiActiveForm("destroy"),a.yiiActiveForm(d.attributes,d.settings)))),void r.removeClass("kv-editable-processing")):(p?(v.append('<div class="help-block"></div>'),v.find(".help-block").html(n.message),v.addClass("has-error")):(c.addClass("has-error"),f.html(n.message)),l.hide(),s.popoverX("show"),void r.removeClass("kv-editable-processing"))}}),n.preventDefault()})}},e.fn.editable=function(t){var a=Array.apply(null,arguments);return a.shift(),this.each(function(){var n=e(this),o=n.data("editable"),r="object"==typeof t&&t;o||n.data("editable",o=new i(this,e.extend({},e.fn.editable.defaults,r,e(this).data()))),"string"==typeof t&&o[t].apply(o,a)})},e.fn.editable.defaults={containerId:"",valueIfNull:"<em>(not set)</em>"}}(window.jQuery);